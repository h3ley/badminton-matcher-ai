<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="manifest" href="/manifest.json">

    <!-- iOS ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ -->
    <link rel="apple-touch-icon" href="/icons/icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">

    <title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏à‡∏±‡∏î‡∏Ñ‡∏π‡πà‡∏ï‡∏µ‡πÅ‡∏ö‡∏î‡∏°‡∏¥‡∏ô‡∏ï‡∏±‡∏ô</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <!-- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå CSS ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å -->
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="/icons/icon-192.png">
</head>
<body class="bg-slate-50 text-slate-800">
    <div id="update-notification" class="hidden fixed top-4 right-4 z-50">
        <button id="update-btn" class="bg-blue-500 text-white font-bold py-2 px-5 rounded-full shadow-lg hover:bg-blue-600">
            ‡∏°‡∏µ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà! ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
        </button>
    </div>

    <div id="app" class="container mx-auto p-3 max-w-5xl">
        <!-- Header -->
        <header class="text-center my-4">
            <h1 class="text-2xl md:text-3xl font-bold text-slate-700">üè∏ ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏à‡∏±‡∏î‡∏Ñ‡∏π‡πà‡∏ï‡∏µ‡πÅ‡∏ö‡∏î</h1>
            <span id="app-version" class="px-2 rounded-md bg-black/5 text-black/60 text-xs select-none">
                loading...
            </span>
            <p class="text-slate-500 mt-1 text-sm">‡∏™‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏™‡∏≤‡∏¢ ‡πÅ‡∏ö‡πà‡∏á‡∏ó‡∏µ‡∏° ‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Å‡∏°</p>
        </header>

        <!-- Setup Section -->
        <section id="setup" class="bg-white p-4 rounded-2xl shadow-sm mb-6">
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label for="player-input-list" class="block text-base font-medium text-slate-600 mb-2">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</label>
                    <textarea id="player-input-list" rows="4" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition text-sm" placeholder="‡∏ß‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏Ñ‡∏ô‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)"></textarea>
                    <button id="add-players-btn" class="mt-2 w-full bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 active:bg-sky-700 transition-colors shadow">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</button>
                </div>
                <div>
                    <label for="court-count" class="block text-base font-medium text-slate-600 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≠‡∏£‡πå‡∏î</label>
                    <input type="number" id="court-count" value="2" min="1" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition">
                </div>
            </div>
        </section>

         <!-- Clear All Button - New Position -->
        <div class="text-right px-1 mb-2">
             <button id="clear-all-btn" class="bg-red-500 text-white font-semibold py-1.5 px-4 rounded-full hover:bg-red-600 transition-colors text-xs">
                ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            </button>
        </div>

        <!-- Player Overview Section -->
        <section class="bg-white p-4 rounded-2xl shadow-sm mb-6">
            <div class="flex flex-wrap justify-center items-center mb-3">
                <h3 class="text-lg font-semibold text-slate-700 text-center">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (<span id="player-total-count">0</span>)</h3>
                <button id="toggle-stats-btn" class="ml-4 text-xs text-sky-600 hover:underline">‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ñ‡∏π‡πà</button>
                <label class="w-full items-center text-slate-500 mt-1 text-xs text-center">
                    <input id="toggle-levels" type="checkbox" class="accent-gray-600">‡∏ã‡πà‡∏≠‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
                </label>  
            </div>          
            <div id="player-list-container" class="flex flex-wrap justify-center items-center gap-2 min-h-[3rem]"></div>
            <div id="stats-container" class="hidden mt-4 pt-4 border-t border-slate-200 ">
                <h4 class="text-sm font-semibold text-center mb-2">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà (Partner)</h4>
                <div id="stats-list" class="text-xs text-slate-600 text-center max-h-48 overflow-y-auto"></div>
            </div>
        </section>

        <!-- Action Buttons -->
        <div class="text-center mb-3">
            <button id="generate-round-btn" class="bg-emerald-500 text-white font-bold py-3 px-6 rounded-full hover:bg-emerald-600 active:bg-emerald-700 transition-transform hover:scale-105 shadow-lg text-lg">üöÄ ‡∏™‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏Ñ‡∏π‡πà‡∏£‡∏≠‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>

        <!-- Message Area -->
        <div id="message-area" class="text-center text-red-500 font-semibold my-3"></div>

        <!-- Results Section -->
        <section id="results-section" >
            <div class="flex justify-center items-center gap-3 mb-4">
                <button id="reshuffle-btn" class="bg-sky-500 text-white font-semibold py-1.5 px-4 rounded-full hover:bg-sky-600 transition-colors text-sm">‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
            </div>  
            <div class="flex justify-center items-center gap-3 mb-4">
                <h2 id="round-counter" class="text-xl font-bold text-slate-700"></h2>
                <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö‡∏Ñ‡∏π‡πà -->
                <button id="swap-pairs-btn" class="bg-violet-500 text-white font-semibold py-1.5 px-4 rounded-full hover:bg-violet-600 transition-colors text-xs">
                    ‡∏™‡∏•‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
                </button>
            </div>

            <div id="current-round-container" class="mb-6"></div>
            <div id="resting-players-container" class="bg-white p-4 rounded-2xl shadow-sm transition-colors duration-300 ">
                <h3 class="text-lg font-semibold text-slate-600 mb-3">üò¥ ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å</h3>
                <div id="resting-list" class="flex flex-wrap gap-2"></div>
            </div>
            <div class="text-center mt-6 mb-6 flex justify-center items-center gap-4">
                <button id="reset-btn" class="bg-amber-500 text-white font-semibold py-1.5 px-4 rounded-full hover:bg-amber-600 transition-colors text-xs">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏Å‡∏°</button>
            </div>
        </section>

        <!-- History Section -->
        <section id="history-section" class="mt-10"">
            <h2 class="text-xl font-bold text-center mb-4 text-slate-700">üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</h2>
            <div id="history-container" class="space-y-4"></div>
        </section>
    </div>

    <!-- Modals -->
    <div id="player-modal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-xl max-w-sm w-full p-5">
            <h3 class="text-lg font-semibold mb-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏°‡∏≤‡πÅ‡∏ó‡∏ô</h3>
            <div id="modal-player-list" class="grid grid-cols-2 gap-2 max-h-64 overflow-y-auto"></div>
            <button id="modal-close-btn" class="mt-5 w-full bg-slate-200 text-slate-700 font-semibold py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
    </div>
    <div id="confirm-modal" class="modal fixed inset-0 bg-black bg-opacity-60 items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-xl max-w-sm w-full p-6 text-center">
            <h3 id="confirm-title" class="text-lg font-bold text-slate-800 mb-2"></h3>
            <p id="confirm-message" class="text-slate-600 text-sm mb-6"></p>
            <div class="flex justify-center gap-4">
                <button id="confirm-no-btn" class="w-full bg-slate-200 text-slate-700 font-semibold py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="confirm-yes-btn" class="w-full bg-red-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-red-600 transition-colors">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
            </div>
        </div>
    </div>

    <!-- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå JavaScript ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å -->
    <script type="module" src="main.js"></script>
    <script src="/version.js"></script>
    <script>
        (async () => {
            const el = document.getElementById('app-version');
            const ver = await getAppVersion();
            // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ logic ‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠ branch ‡∏à‡∏≤‡∏Å‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡πá‡πÉ‡∏™‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ
            el.textContent = `v${ver}`;
        })();
    </script>
</body>
</html>